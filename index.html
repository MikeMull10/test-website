<!DOCTYPE html>
<html>
    <head>
        <title>RSC Demo Website</title>
        <link rel="stylesheet" type="text/css" href="style.css">
        <link rel="shortcut icon" type="image/x-icon" href="RSC-Icon.ico"/>
        <script src="https://kit.fontawesome.com/810972f47f.js" crossorigin="anonymous"></script>
        <script src="navbar.js"></script>
    </head>
    <script>
        
    </script>
    <button id="nav-btn" onclick="switchNav()">
       <i id="n" class="fa-solid fa-arrow-right fa-2xl"></i>
    </button>
    <div id="nav" class="navbar">
        <a>NAVBAR</a>
    </div>
    <div id="move" class="outer-container">
        <div class="middle-container">
            <div class="inner-container">
                <div class="card-container">
                    <div class="card logo" id="avatar">
                        <!-- <img src="https://cdn.discordapp.com/avatars/336146049053753346/25563d778f8068d739ad9a127d18adcd.webp?size=320"> -->
                        <img src="">
                    </div>
                    <div class="card name" id="username"></div>
                    <div class="card stats">
                        Loading...
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        window.onload = () => {
            const fragment = new URLSearchParams(window.location.hash.slice(1));
            const [accessToken, tokenType] = [fragment.get('access_token'), fragment.get('token_type')];

            console.log(accessToken, tokenType);

            if (!accessToken) {console.log("NO ACCESS TOKEN");}

            fetch('https://discord.com/api/users/@me', {
                headers: {
                    authorization: `${tokenType} ${accessToken}`,
                },
            })
            .then(result => result.json())
            .then(response => {
                console.log(response);
                const { username, discriminator, avatar, id} = response;
                //set the welcome username string
                document.getElementById('name').innerText = ` ${username}#${discriminator}`;

                //set the avatar image by constructing a url to access discord's cdn
                document.getElementById("avatar").src = `https://cdn.discordapp.com/avatars/${id}/${avatar}.jpg`;
            })
            .catch(console.error);
        }
    </script>
</html>